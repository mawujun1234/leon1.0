<!DOCTYPE html> 
<html>
<head>
<meta charset="utf-8">
<title>登录</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="jquery.mobile/jquery.mobile-1.4.3.min.css" rel="stylesheet" type="text/css"/>
<script src="jquery.mobile/jquery-2.1.1.min.js" type="text/javascript"></script>
<script src="jquery.mobile/jquery.mobile-1.4.3.min.js" type="text/javascript"></script>
<script src="jquery-validation/dist/jquery.validate.min.js" type="text/javascript"></script>
<script src="js/main.js" type="text/javascript"></script>
<style type="text/css">
label.error{
    color: red;
    font-size: 16px;
    font-weight: normal;
    line-height: 1.4;
    margin-top: 0.5em;
    width: 100%;
    float: none;
}
</style>

<script type="application/javascript">
	
</script>
</head> 
<body> 

<div data-role="page" id="page">
	<div data-role="header">
        <h1>生产调度系统</h1>
	</div>
	<div role="main" class="ui-content">
    <form id="formLogin" class="validate"> 
        <div style="padding:10px 20px;">
            <h3>请登录:</h3>
            <input type="text" name="loginName" id="loginName"  placeholder="用户名" data-theme="a" class="required">
            <input type="password" name="password" id="password"  placeholder="密码" data-theme="a" class="required">
            <!--
            <fieldset data-role="controlgroup" >
               <input type="checkbox" name="rememberMe" id="rememberMe" value="true" />
               <label for="rememberMe">保持登录状态</label>
            </fieldset>
            -->
            <div id="errorMsg" style="color:red;height:36px;font-weight:bold;">
            
            </div>
            <button type="submit" id="submit" data-theme="b" class="ui-btn ui-corner-all ui-shadow ui-btn-b ui-btn-icon-left ">登录</button>
        </div>
 	</form>
	</div>
	<footer data-role="footer" ><h1>©2014 奥维集团</h1></footer>
</div>
<script type="text/javascript">
$(function() { 
	 $("#formLogin").validate({ 
		submitHandler: function(form) { 
			//console.log("Call Login Action"); 
			var values=$(form).serializeJson();
			$.showLoader("正在登陆....");
			$.ajax({   
				url : $.ServerPath+"/mobile/login.do",  
				data:values,  
				success : function(data){  
					if(data.success==true){
						sessionStorage.setItem("user",JSON.stringify(data.root));
						//$.mobile.pageContainer.pagecontainer('change', "messages.html", {
						//	transition: 'slide',
						//	reload    : true
						//});
						location.href="messages.html";
					}else{
						//$("#errorMsg").html(data.reasons.reason);
						if(data.reasons.code=="noLogin"){
							location.href="login.html";
							return;
						}
					}
					$.hideLoader();  
				}
			});   
		} 
	}); 
	/**
    $('#submit').bind('click', function() { 
	//alert(1);
		//$.mobile.changePage('index.html');
		location.href="messages.html";
	});
	**/
});
</script>

</body>
</html>
