<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"
"http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">

<!-- mawujun qq:16064988 e-mail:16064988@qq.com 承接各种项目 -->
<!-- 注意文件名称为:Example_${DbName}_Mapper.xml-->
<mapper namespace="com.mawujun.parameter.ParameterSubjectRespository">
	<!-- 查询各个主体拥有的参数 ============================================  -->
	<select id="query_SYSTEM" resultType="com.mawujun.parameter.ParameterSubjectVO" >
    	select '系统' as subjectName,a.* from leon_parameter_subject a where parameter_Id=#{parameter_Id} and subjectType=#{subjectType}
    </select>
    
    <select id="query_USER" resultType="com.mawujun.parameter.ParameterSubjectVO" >
    	select b.name as subjectName,a.* from leon_parameter_subject a ,leon_user b
    	where a.SUBJECT_ID=b.id and parameter_Id=#{parameter_Id} and subjectType=#{subjectType}
    </select>
    
     <select id="query_GROUP" resultType="com.mawujun.parameter.ParameterSubjectVO" >
    	select b.name as subjectName,a.* from leon_parameter_subject a ,leon_group b
    	where a.SUBJECT_ID=b.id and parameter_Id=#{parameter_Id} and subjectType=#{subjectType}
    </select>
    
     <select id="query_ROLE" resultType="com.mawujun.parameter.ParameterSubjectVO" >
    	select b.name as subjectName,a.* from leon_parameter_subject a ,leon_role b
    	where a.SUBJECT_ID=b.id and parameter_Id=#{parameter_Id} and subjectType=#{subjectType}
    </select>
	<!-- 查询各个主体拥有的参数 =============================================================================================== -->
	
	<!-- 查询用户所属的职位，组织单元，用户组，角色===============================================================  -->
	<select id="query_USER_part_of" resultType="com.mawujun.parameter.ParameterValue" parameterType="map">
		select distinct a.subject_id as "key",b.parametervalue as value,a.order1 from (
		select distinct '1' as order1,id as subject_id from leon_user where id=#{user_id}
    	union all
    	select distinct '2' as order1,group_id as subject_id from leon_group_user where user_id=#{user_id}
    	union all
    	select distinct '3' as order1,role_id  as subject_id from leon_user_role where user_id=#{user_id}
    	) a, leon_parameter_subject b
    	where a.subject_id=b.subject_id and b.parameter_id=#{parameter_id}
    	order by a.order1
    </select>
	
	<!-- ================================================================================= -->
</mapper>