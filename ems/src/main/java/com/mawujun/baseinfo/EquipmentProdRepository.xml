<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"
"http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">

<!-- mawujun qq:16064988 e-mail:16064988@qq.com-->
<mapper namespace="com.mawujun.baseinfo.EquipmentProdRepository">

	<select id="queryProdGrid" resultType="com.mawujun.baseinfo.EquipmentProdVO" parameterType="map">
    	SELECT a.*,b.name as brand_name
	    FROM ems_equipmentprod a,ems_brand b 
		where a.brand_id=b.id
		<if test="style!=null and style !=''">
		and a.style  like #{style}
		</if>
		<if test="status!=null">
		and a.status=#{status}
		</if>
		<if test="subtype_id!=null">
		and a.subtype_id=#{subtype_id}
		</if>
		<if test="parent_id!=null">
		and a.parent_id=#{parent_id}
		</if>
		<if test="parent_id==null">
		and a.parent_id is null
		</if>
		order by a.id
    </select>
    
    <!-- 在答应条码的时候获取 套件下面的零件 -->
    <select id="queryProd_tj_children" resultType="com.mawujun.baseinfo.EquipmentProd" >
    	SELECT a.*
	    FROM ems_equipmentprod a
	    where a.parent_id=#{parent_id}
	    order by a.id
    </select>
    
    <!-- 判断品名是否已经在设备中被使用了，如果被使用了表明被打印了，而且如果型号变了，这样就不能修改型号了-->
    <select id="checkProd_used_in_equipment" resultType="String">
    	select distinct style from ems_equipment
    	where prod_id=#{prod_id}
    </select>
  
</mapper>

